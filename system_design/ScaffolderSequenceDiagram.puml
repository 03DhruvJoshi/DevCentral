@startuml name SequenceDiagram
autonumber

actor "Platform Engineer" as User
participant "React Frontend\n(ScaffolderPage)" as FE
participant "Express API" as API
participant "Prisma Client" as ORM
database "PostgreSQL" as DB

title Create New Scaffolder Template Process

User -> FE: Fill "Contribute Template" Form
User -> FE: Click "Publish Template"

activate FE
  FE -> FE: Validate Form (Zod Schema)
  FE -> API: POST /api/templates
  
  activate API
    API -> API: Validate Request Body
    API -> ORM: prisma.template.create({ data })
    
    activate ORM
      ORM -> DB: INSERT INTO "Template" ...
      DB --> ORM: Return New Row
    deactivate ORM
    
    API --> FE: Return 201 Created (JSON)
  deactivate API

  FE -> FE: Invalidate Query Cache (React Query)
  FE -> API: GET /api/templates
  
  activate API
    API -> ORM: prisma.template.findMany()
    activate ORM
      ORM -> DB: SELECT * FROM "Template"
      DB --> ORM: Return List
    deactivate ORM
    API --> FE: Return Updated List
  deactivate API
  
  FE -> User: Show Success Toast & Update UI
deactivate FE

@enduml